{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?eea7"],"names":["for","class","onSubmit","eError","type","id","email","eBlur","pError","password","pBlur","disabled","isSubmitting","isTooManyAttempts","useLoginForm","store","useStore","router","useRouter","useForm","handleSubmit","submitCount","useField","yup","trim","required","value","errorMessage","handleBlur","MIN_LENGTH","min","computed","watch","val","setTimeout","values","dispatch","push","setup","route","query","message","error","render","__scopeId"],"mappings":"qNAEE,eAAwB,UAApB,mBAAe,G,EAGlB,eAAgC,SAAzBA,IAAI,SAAQ,SAAK,G,YAMxB,eAAoC,SAA7BA,IAAI,YAAW,UAAM,G,mBAOCC,MAAM,e,wEAjBrC,eAoBO,QApBDA,MAAM,iBAAkB,SAAM,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CACrD,EAEA,eAIM,OAJAD,MAAK,yBAA8B,EAAAE,U,CACxC,E,eACA,eAA6D,SAAtDC,KAAK,QAAQC,GAAG,Q,qDAAiB,EAAAC,MAAK,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAd,EAAAD,SAC3B,EAAAH,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAG/B,eAIM,OAJAF,MAAK,yBAA8B,EAAAO,U,CACxC,E,eACA,eAAsE,SAA/DJ,KAAK,WAAWC,GAAG,W,qDAAoB,EAAAI,SAAQ,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAjB,EAAAD,YACjC,EAAAD,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAG/B,eAAsG,UAA9FP,MAAM,cAAcG,KAAK,SAAUO,SAAU,EAAAC,cAAgB,EAAAC,mBAAmB,QAAK,gBAElF,EAAAA,mB,iBAAX,eAEM,MAFN,EAAkD,8C,sICZ7C,SAASC,IACf,IAAMC,EAAQC,iBACRC,EAASC,iBAFe,EAGsBC,iBAA5CC,EAHsB,EAGtBA,aAAcR,EAHQ,EAGRA,aAAcS,EAHN,EAGMA,YAHN,EAIoCC,eACjE,QACAC,SAEEC,OACAC,SAAS,4BACTnB,MAAM,6BANMA,EAJe,EAItBoB,MAA4BvB,EAJN,EAIRwB,aAAkCpB,EAJ1B,EAIcqB,WAStCC,EAAa,EAbW,EAcuCP,eACpE,WACAC,SAEEC,OACAC,SAAS,6BACTK,IAAID,EAJN,4CAIuDA,EAJvD,eAFcpB,EAde,EActBiB,MAA+BlB,EAdT,EAcLmB,aAAkCjB,EAd7B,EAciBkB,WASzCf,EAAoBkB,gBAAS,kBAAMV,EAAYK,OAAS,KAE9DM,eAAMnB,GAAmB,SAAAoB,GACpBA,GACHC,YAAW,WACVb,EAAYK,MAAQ,IAClB,SAIL,IAAMxB,EAAWkB,EAAY,yDAAC,WAAOe,GAAP,0GAEtBpB,EAAMqB,SAAS,aAAcD,GAFP,OAG5BlB,EAAOoB,KAAK,KAHgB,0GAAD,uDAS7B,MAAO,CACN/B,QACAH,SACAI,QACAE,WACAD,SACAE,QACAR,WACAU,eACAC,qB,gBD3Ba,GACdyB,MADc,WAEb,IAAMC,EAAQ,iBACRxB,EAAQ,iBAOd,OANIwB,EAAMC,MAAMC,SACf1B,EAAMqB,SAAS,aAAc,CAC5BV,MAAO,OAAAgB,EAAA,MAAMH,EAAMC,MAAMC,SACzBrC,KAAM,YAGR,kBACIU,OEtCN,EAAO6B,OAASA,EAChB,EAAOC,UAAY,kBAEJ","file":"js/chunk-2d0be70b.426e5071.js","sourcesContent":["<template>\r\n\t<form class=\"card container\" @submit.prevent=\"onSubmit\">\r\n\t\t<h1>Войти в систему</h1>\r\n\r\n\t\t<div :class=\"['form-control', { invalid: eError }]\">\r\n\t\t\t<label for=\"email\">Email</label>\r\n\t\t\t<input type=\"email\" id=\"email\" v-model=\"email\" @blur=\"eBlur\">\r\n\t\t\t<small v-if=\"eError\">{{ eError }}</small>\r\n\t\t</div>\r\n\r\n\t\t<div :class=\"['form-control', { invalid: pError }]\">\r\n\t\t\t<label for=\"password\">Пароль</label>\r\n\t\t\t<input type=\"password\" id=\"password\" v-model=\"password\" @blur=\"pBlur\">\r\n\t\t\t<small v-if=\"pError\">{{ pError }}</small>\r\n\t\t</div>\r\n\r\n\t\t<button class=\"btn primary\" type=\"submit\" :disabled=\"isSubmitting || isTooManyAttempts\">Войти</button>\r\n\r\n\t\t<div v-if=\"isTooManyAttempts\" class=\"text-danger\">\r\n\t\t\tСлишком много попыток, попробуйте позже\r\n\t\t</div>\r\n\t</form>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport { useLoginForm } from '../use/login-form'\r\nimport { error } from '../utils/error'\r\n\r\nexport default {\r\n\tsetup() {\r\n\t\tconst route = useRoute()\r\n\t\tconst store = useStore()\r\n\t\tif (route.query.message) {\r\n\t\t\tstore.dispatch('setMessage', {\r\n\t\t\t\tvalue: error(route.query.message),\r\n\t\t\t\ttype: 'warning'\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn {\r\n\t\t\t...useLoginForm()\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>","import * as yup from 'yup'\r\nimport { useField, useForm } from 'vee-validate'\r\nimport { computed, watch } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\n\r\nexport function useLoginForm() {\r\n\tconst store = useStore()\r\n\tconst router = useRouter()\r\n\tconst { handleSubmit, isSubmitting, submitCount } = useForm()\r\n\tconst { value: email, errorMessage: eError, handleBlur: eBlur } = useField(\r\n\t\t'email',\r\n\t\tyup\r\n\t\t\t.string()\r\n\t\t\t.trim()\r\n\t\t\t.required('Пожалуйста введите email')\r\n\t\t\t.email('Введите корректный email')\r\n\t)\r\n\r\n\tconst MIN_LENGTH = 6\r\n\tconst { value: password, errorMessage: pError, handleBlur: pBlur } = useField(\r\n\t\t'password',\r\n\t\tyup\r\n\t\t\t.string()\r\n\t\t\t.trim()\r\n\t\t\t.required('Пожалуйста введите пароль')\r\n\t\t\t.min(MIN_LENGTH, `Длина пароля должна быть не менее ${MIN_LENGTH} символов`)\r\n\t)\r\n\r\n\tconst isTooManyAttempts = computed(() => submitCount.value >= 3)\r\n\r\n\twatch(isTooManyAttempts, val => {\r\n\t\tif (val) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsubmitCount.value = 0\r\n\t\t\t}, 1500)\r\n\t\t}\r\n\t})\r\n\r\n\tconst onSubmit = handleSubmit(async (values) => {\r\n\t\ttry {\r\n\t\t\tawait store.dispatch('auth/login', values)\r\n\t\t\trouter.push('/')\r\n\t\t} catch(e) {\r\n\t\t\t\r\n\t\t}\r\n\t})\r\n\r\n\treturn {\r\n\t\temail,\r\n\t\teError,\r\n\t\teBlur,\r\n\t\tpassword,\r\n\t\tpError,\r\n\t\tpBlur,\r\n\t\tonSubmit,\r\n\t\tisSubmitting,\r\n\t\tisTooManyAttempts\r\n\t}\r\n}","import { render } from \"./Auth.vue?vue&type=template&id=2d410cd2&scoped=true\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-2d410cd2\"\n\nexport default script"],"sourceRoot":""}